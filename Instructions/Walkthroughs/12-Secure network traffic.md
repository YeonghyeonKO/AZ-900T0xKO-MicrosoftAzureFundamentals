---
wts:
    title: '12 - 네트워크 트래픽 보안'
    module: '모듈 03 - 보안, 개인 정보 보호, 규정 준수 및 신뢰'
---
# 12 - 네트워크 트래픽 보안

이 연습에서는 네트워크 보안 그룹을 구성합니다.

# 작업 1: 가상 머신 만들기

이 작업에서는 Windows Server 2019 Datacenter 가상 머신을 만듭니다. 

1. [Azure Portal](https://portal.azure.com)에 로그인합니다.

2. **모든 서비스** 블레이드에서 **가상 머신**을 검색하여 선택한 다음 **+ 추가** 를 클릭합니다.

3. **기본** 탭에서 다음 정보를 채웁니다(다른 항목은 기본값을 사용).

    | 설정 | 값 |
    |  -- | -- |
    | 구독 | **보유한 구독 선택**|
    | 리소스 그룹 | **myRGSecure**(새로 만들기) |
    | 가상 머신 이름 | **SimpleWinVM** |
    | 위치 | **(미국) 미국 동부**|
    | 이미지 | **Windows Server 2019 Datacenter**|
    | 크기 | **Standard D2s v3**|
    | 관리자 계정 사용자 이름 | **azureuser** |
    | 관리자 계정 암호 | **Pa$$w0rd1234**|
    | 인바운드 포트 규칙 | **None**|
    | | |

4. **네트워킹** 탭으로 전환하고 다음 설정을 구성합니다.

    | 설정 | 값 |
    | -- | -- |
    | NIC 네트워크 보안 그룹 | **None**|
    | | |

5. **관리** 탭으로 전환하고 **모니터링** 섹션에서 다음 설정을 선택합니다.

    | 설정 | 값 |
    | -- | -- |
    | 부팅 진단 | **사용 안 함**|
    | | |

6. 나머지 기본값을 그대로 유지한 다음 페이지 하단에 있는 **검토 + 만들기** 단추를 클릭합니다.

7. 유효성 검사가 통과되면 **만들기** 단추를 클릭합니다. 가상 머신을 배포하는 데 5분 정도 걸릴 수 있습니다.

8. 배포를 모니터링합니다. 리소스 그룹 및 가상 머신을 만드는 데 몇 분 정도 걸릴 수 있습니다. 

9. 배포 블레이드 또는 알림 영역에서 **리소스로 이동**을 클릭합니다. 

10. **SimpleWinVM** 가상 머신 블레이드에서 **네트워킹**을 클릭하고, **인바운드 포트 규칙** 탭을 검토하고, 가상 머신의 네트워크 인터페이스나 네트워크 인터페이스가 연결된 서브넷과 연관된 네트워크 보안 그룹이 없는지 확인합니다.

    **참고**: 네트워크 인터페이스의 이름을 확인하세요. 다음 작업에 필요합니다.

# 작업 2: 네트워크 보안 그룹을 만듭니다.

이 작업에서는 네트워크 보안 그룹을 만들고 네트워크 인터페이스와 연결합니다.

1. **모든 서비스** 블레이드에서 **네트워크 보안 그룹**을 검색하여 선택한 다음 **+ 추가**를 클릭합니다.

2. **네트워크 보안 그룹 만들기** 블레이드의 **기본** 탭에서 다음 설정을 지정합니다.

    | 설정 | 값 |
    | -- | -- |
    | 구독 | **보유한 구독 선택** |
    | 리소스 그룹 | **myRGSecure** |
    | 이름 | **myNSGSecure** |
    | 지역 | **(미국) 미국 동부**  |
    | | |

3. **검토 + 만들기**를 클릭하고 유효성 검사를 수행한 후 **만들기**를 클릭합니다.

4. NSG가 생성된 후 **리소스로 이동**을 클릭합니다.

5. **설정**에서 **네트워크 인터페이스**를 클릭한 다음 **+ 연결**을 클릭합니다.

6. 이전 작업에서 확인한 네트워크 인터페이스를 선택합니다. 

# 작업 3: RDP를 허용하는 인바운드 보안 포트 규칙을 구성합니다.

이 작업에서는 인바운드 보안 포트 규칙을 구성하여 가상 머신에 대한 RDP 트래픽을 허용합니다. 

1. Azure Portal에서 **SimpleWinVM** 가상 머신의 블레이드로 이동합니다. 

2. **개요** 창에서 **연결**을 클릭합니다.

3. RDP를 사용하여 가상 머신 연결을 시도합니다. 기본적으로 네트워크 보안 그룹은 RDP를 허용하지 않습니다. 오류 창을 닫습니다. 

    ![가상 머신 연결에 실패했다는 오류 메시지의 스크린샷.](../images/1201.png)

4. 가상 머신 블레이드에서 **설정** 섹션으로 스크롤하고, **네트워킹**을 클릭하고, **myNSGSecure(연결 네트워크 인터페이스: myVMNic)** 네트워크 보안 그룹의 인바운드 규칙이 가상 네트워크와 부하 분산 장치 프로브 내의 트래픽을 제외한 모든 인바운드 트래픽을 거부하는 것을 확인합니다.

5. **인바운드 포트 규칙** 탭에서 **인바운드 포트 규칙 추가**를 클릭합니다. 완료되면 **추가**를 클릭합니다. 

    | 설정 | 값 |
    | -- | -- |
    | 원본 | **모두**|
    | 원본 포트 범위 | **\*** |
    | 대상 | **모두** |
    | 대상 포트 범위 | **3389** |
    | 프로토콜 | **TCP** |
    | 작업 | **허용** |
    | 우선 순위 | **300** |
    | 이름 | **AllowRDP** |
    | | |

6. 규칙이 프로비전될 때까지 기다린 다음 RDP를 가상 머신에 다시 시도합니다. 이번에는 성공해야 합니다. 사용자는 **azureuser**이고 암호는 **Pa$$w0rd1234**입니다.

# 작업 4: 인터넷 액세스를 거부하는 아웃바운드 보안 포트 규칙 구성

이 작업에서는 인터넷 액세스를 거부할 NSG 아웃바운드 포트 규칙을 만든 후에 테스트를 수행하여 규칙이 작동하는지 확인합니다.

1. 가상 머신 RDP 세션에서 계속합니다. 

2. 머신이 시작되면 **Internet Explorer** 브라우저를 엽니다. 

3. **https://www.bing.com**에 액세스할 수 있는지 확인한 후에 Internet Explorer를 닫습니다. IE 보안 강화 팝업을 통해 작업해야 합니다. 

    **참고**: 이제 아웃바운드 인터넷 액세스를 거부하는 규칙을 구성합니다. 

4. Azure Portal에서 **SimpleWinVM** 가상 머신의 블레이드로 다시 이동합니다. 

5. **설정**에서 **네트워킹**을 클릭하고 **아웃바운드 포트 규칙**을 클릭합니다.

6. **AllowInternetOutbound**라는 규칙이 있습니다. 이 규칙은 기본 규칙이며 제거할 수 없습니다. 

7. **myNSGSecure(연결 네트워크 인터페이스: myVMNic)** 네트워크 보안 그룹의 오른쪽에서 **아웃바운드 포트 규칙 추가**를 클릭하고, 인터넷 트래픽을 거부할 더 높은 우선 순위의 새 아웃바운드 보안 규칙을 구성합니다. 완료되면 **추가**를 클릭합니다. 

    | 설정 | 값 |
    | -- | -- |
    | 원본 | **모두**|
    | 원본 포트 범위 | **\*** |
    | 대상 | **서비스 태그** |
    | 대상 서비스 태그 | **인터넷** |
    | 대상 포트 범위 | **\*** |
    | 프로토콜 | **TCP** |
    | 작업 | **거부** |
    | 우선 순위 | **4000** |
    | 이름 | **DenyInternet** |
    | | |

8. RDP 세션으로 돌아갑니다. 

9. **https://www.microsoft.com**으로 이동합니다. 페이지가 표시되지 않아야 합니다. 추가적인 IE 보안 강화 팝업을 통해 작업해야 할 수도 있습니다.  

**참고**: 추가 비용을 방지하려면 이 리소스 그룹을 제거할 수 있습니다. 리소스 그룹을 검색하고 리소스 그룹을 클릭한 다음 **리소스 그룹 삭제**를 클릭합니다. 리소스 그룹의 이름을 확인한 다음 **삭제**를 클릭합니다. **알림**을 모니터링하여 삭제가 어떻게 진행되는지 확인합니다.
